(()=>{var e={};e.id=3083,e.ids=[3083],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},3066:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>o}),t(6050),t(83336),t(71363);var r=t(36576),a=t(72007),i=t(21818),n=t.n(i),l=t(88897),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let o=["",{children:["app",{children:["customers",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,6050)),"/home/ubuntu/make_estimate/nextjs_space/app/app/customers/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,83336)),"/home/ubuntu/make_estimate/nextjs_space/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,71363,23)),"next/dist/client/components/not-found-error"]}],d=["/home/ubuntu/make_estimate/nextjs_space/app/app/customers/page.tsx"],u="/app/customers/page",m={require:t,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/app/customers/page",pathname:"/app/customers",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},93499:(e,s,t)=>{Promise.resolve().then(t.bind(t,46826))},46826:(e,s,t)=>{"use strict";t.d(s,{CustomersClient:()=>v});var r=t(62901),a=t(24383),i=t(22270),n=t(27878),l=t(250),c=t(23803),o=t(82657),d=t(65923),u=t(97718),m=t(91046),p=t(66843),x=t(19918),h=t(32614),j=t(71028),g=t(10333),y=t(39350);function v({customers:e}){let[s,t]=(0,a.useState)(e??[]),[v,f]=(0,a.useState)(""),[N,b]=(0,a.useState)(!1),[C,w]=(0,a.useState)(""),[_,P]=(0,a.useState)(""),[q,Z]=(0,a.useState)(""),[A,k]=(0,a.useState)(""),[S,L]=(0,a.useState)(!1),z=(s??[]).filter(e=>e?.name?.toLowerCase()?.includes?.(v?.toLowerCase?.()??"")||e?.email?.toLowerCase()?.includes?.(v?.toLowerCase?.()??"")),E=async()=>{if(!C?.trim?.()){y.ZP.error("Please enter a customer name");return}L(!0);try{let e=await fetch("/api/customers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:C,email:_||null,phone:q||null,address:A||null})}),r=await e.json();if(!e.ok){y.ZP.error(r?.error||"Failed to create customer");return}t([...s??[],r]),b(!1),w(""),P(""),Z(""),k(""),y.ZP.success("Customer created")}catch(e){y.ZP.error("An error occurred")}finally{L(!1)}},M=async e=>{if(confirm("Are you sure you want to delete this customer?"))try{if(!(await fetch(`/api/customers/${e}`,{method:"DELETE"})).ok){y.ZP.error("Failed to delete customer");return}t((s??[]).filter(s=>s?.id!==e)),y.ZP.success("Customer deleted")}catch(e){y.ZP.error("An error occurred")}};return r.jsx(i.AppLayout,{children:(0,r.jsxs)("div",{className:"p-6 max-w-5xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Customers"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Manage your customer database"})]}),(0,r.jsxs)(n.z,{onClick:()=>b(!0),className:"shadow-md",children:[r.jsx(u.Z,{className:"w-4 h-4 mr-2"}),"Add Customer"]})]}),(0,r.jsxs)("div",{className:"relative mb-6",children:[r.jsx(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),r.jsx(l.I,{placeholder:"Search customers...",value:v,onChange:e=>f(e.target.value),className:"pl-10"})]}),(0,r.jsxs)(c.Zb,{className:"shadow-md border-0",children:[r.jsx(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"text-lg",children:["All Customers (",z?.length??0,")"]})}),r.jsx(c.aY,{children:(z?.length??0)===0?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(p.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-500",children:"No customers found"}),r.jsx(n.z,{variant:"outline",className:"mt-4",onClick:()=>b(!0),children:"Add your first customer"})]}):r.jsx("div",{className:"space-y-3",children:(z??[]).map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors group",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-cyan-400 to-teal-400 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-white font-semibold text-lg",children:e?.name?.charAt?.(0)?.toUpperCase?.()??"C"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium text-gray-900",children:e?.name}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e?.email&&(0,r.jsxs)("span",{className:"flex items-center",children:[r.jsx(x.Z,{className:"w-3 h-3 mr-1"}),e.email]}),e?.phone&&(0,r.jsxs)("span",{className:"flex items-center",children:[r.jsx(h.Z,{className:"w-3 h-3 mr-1"}),e.phone]})]})]})]}),r.jsx(n.z,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-500",onClick:()=>M(e?.id),children:r.jsx(j.Z,{className:"w-4 h-4"})})]},e?.id))})})]}),r.jsx(d.Vq,{open:N,onOpenChange:b,children:(0,r.jsxs)(d.cZ,{children:[r.jsx(d.fK,{children:r.jsx(d.$N,{children:"Add New Customer"})}),(0,r.jsxs)("div",{className:"space-y-4 py-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{htmlFor:"name",children:"Name *"}),r.jsx(l.I,{id:"name",placeholder:"Customer name",value:C,onChange:e=>w(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{htmlFor:"email",children:"Email"}),r.jsx(l.I,{id:"email",type:"email",placeholder:"customer@email.com",value:_,onChange:e=>P(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{htmlFor:"phone",children:"Phone"}),r.jsx(l.I,{id:"phone",placeholder:"Phone number",value:q,onChange:e=>Z(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o._,{htmlFor:"address",children:"Address"}),r.jsx(l.I,{id:"address",placeholder:"Address",value:A,onChange:e=>k(e.target.value)})]})]}),(0,r.jsxs)(d.cN,{children:[r.jsx(n.z,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),(0,r.jsxs)(n.z,{onClick:E,disabled:S,children:[S?r.jsx(g.Z,{className:"w-4 h-4 animate-spin mr-2"}):null,"Add Customer"]})]})]})})]})})}},19918:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},32614:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},6050:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u,dynamic:()=>d});var r=t(83537),a=t(57978),i=t(86023),n=t(15438),l=t(83178);let c=(0,t(88895).createProxy)(String.raw`/home/ubuntu/make_estimate/nextjs_space/app/app/customers/_components/customers-client.tsx#CustomersClient`);var o=t(90391);let d="force-dynamic";async function u(){let e=await (0,a.getServerSession)(i.L);e?.user||(0,n.redirect)("/login");let s=e.user?.companyId;s||(0,n.redirect)("/login"),(await (0,o.qf)(s)).hasActiveSubscription||(0,n.redirect)("/pricing?subscription=required");let t=await l._.customer.findMany({where:{companyId:s},orderBy:{name:"asc"}});return r.jsx(c,{customers:JSON.parse(JSON.stringify(t??[]))})}}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[4372,7329,5990,1303,1263,2116,5882,391,8241,7843],()=>t(3066));module.exports=r})();