(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{5638:function(e,a,s){Promise.resolve().then(s.bind(s,4379))},4379:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return l}});var t=s(5444),r=s(7367),n=s(9827),c=s(5522);function i({className:e,...a}){return(0,t.jsx)("div",{className:(0,c.cn)("animate-pulse rounded-md bg-muted",e),...a})}function l(){return(0,t.jsx)(r.AppLayout,{children:(0,t.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(i,{className:"h-8 w-8 rounded"}),(0,t.jsx)(i,{className:"h-8 w-64"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(i,{className:"h-5 w-16"}),(0,t.jsx)(i,{className:"h-10 w-28"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)(i,{className:"h-10 w-48"}),(0,t.jsx)(i,{className:"h-10 w-10"})]}),(0,t.jsx)("div",{className:"flex flex-col lg:flex-row gap-6",children:(0,t.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,t.jsx)(n.Zb,{className:"shadow-md border-0",children:(0,t.jsx)(n.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,t.jsx)(i,{className:"h-16 w-32"}),(0,t.jsx)(i,{className:"h-16 w-32"}),(0,t.jsx)(i,{className:"h-16 w-32"}),(0,t.jsx)(i,{className:"h-16 w-40"})]})})}),[1,2].map(e=>(0,t.jsxs)(n.Zb,{className:"shadow-md border-0",children:[(0,t.jsx)(n.Ol,{className:"pb-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(i,{className:"h-5 w-5"}),(0,t.jsx)(i,{className:"h-6 w-48"}),(0,t.jsx)(i,{className:"h-4 w-16"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i,{className:"h-6 w-24"}),(0,t.jsx)(i,{className:"h-8 w-8"})]})]})}),(0,t.jsx)(n.aY,{className:"pt-0",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 py-2 border-b",children:[(0,t.jsx)(i,{className:"h-4 w-6"}),(0,t.jsx)(i,{className:"h-4 w-12"}),(0,t.jsx)(i,{className:"h-4 flex-1"}),(0,t.jsx)(i,{className:"h-4 w-16"}),(0,t.jsx)(i,{className:"h-4 w-20"}),(0,t.jsx)(i,{className:"h-4 w-16"}),(0,t.jsx)(i,{className:"h-4 w-20"}),(0,t.jsx)(i,{className:"h-4 w-16"}),(0,t.jsx)(i,{className:"h-4 w-24"})]}),[1,2,3].map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2 py-2",children:[(0,t.jsx)(i,{className:"h-4 w-6"}),(0,t.jsx)(i,{className:"h-4 w-10"}),(0,t.jsx)(i,{className:"h-8 flex-1"}),(0,t.jsx)(i,{className:"h-8 w-16"}),(0,t.jsx)(i,{className:"h-8 w-20"}),(0,t.jsx)(i,{className:"h-8 w-16"}),(0,t.jsx)(i,{className:"h-6 w-20"}),(0,t.jsx)(i,{className:"h-8 w-16"}),(0,t.jsx)(i,{className:"h-6 w-24"}),(0,t.jsx)(i,{className:"h-8 w-8"})]},e))]})})]},e)),(0,t.jsx)(i,{className:"h-10 w-36"}),(0,t.jsx)(n.Zb,{className:"shadow-md border-0",children:(0,t.jsx)(n.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,t.jsx)(i,{className:"h-16 w-32"}),(0,t.jsx)(i,{className:"h-16 w-32"}),(0,t.jsx)(i,{className:"h-16 w-32"})]})})})]})})]})})}},7367:function(e,a,s){"use strict";s.d(a,{AppLayout:function(){return C}});var t=s(5444),r=s(5762),n=s(9047),c=s(9300),i=s(1084),l=s(5522),d=s(1384),o=s(4624),h=s(5038),u=s(6488),m=s(6378),x=s(2019),f=s(5077),p=s(9484),j=s(6771),y=s(3572),g=s(1137),N=s(7480),b=s(2422);let w=[{name:"Dashboard",href:"/app/dashboard",icon:d.Z},{name:"Customers",href:"/app/customers",icon:o.Z},{name:"Team",href:"/app/team",icon:h.Z},{name:"Settings",href:"/app/settings",icon:u.Z}],v=[{name:"Overview",href:"/app/glorand",icon:m.Z},{name:"Users",href:"/app/glorand?tab=users",icon:o.Z},{name:"Companies",href:"/app/glorand?tab=companies",icon:x.Z},{name:"Coupons",href:"/app/glorand?tab=coupons",icon:f.Z}];function k(){let e=(0,n.usePathname)(),{data:a}=(0,r.useSession)()||{},[s,d]=(0,c.useState)(!1),[o,h]=(0,c.useState)(!1);(0,c.useEffect)(()=>{fetch("/api/admin/check").then(e=>e.json()).then(e=>h(e.isAdmin)).catch(()=>h(!1))},[a?.user?.email]);let u=e?.startsWith("/app/glorand"),m=o&&u?v:w;return(0,t.jsxs)("div",{className:(0,l.cn)("h-screen bg-white border-r border-gray-200 flex flex-col transition-all duration-300 shadow-sm",s?"w-20":"w-64"),children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(i.default,{href:o&&u?"/app/glorand":"/app/dashboard",className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:(0,l.cn)("w-10 h-10 rounded-xl flex items-center justify-center shadow-md",o&&u?"bg-gradient-to-br from-amber-500 to-orange-500":"bg-gradient-to-br from-cyan-500 to-teal-500"),children:o&&u?(0,t.jsx)(p.Z,{className:"w-5 h-5 text-white"}):(0,t.jsx)(j.Z,{className:"w-5 h-5 text-white"})}),!s&&(0,t.jsx)("span",{className:(0,l.cn)("text-lg font-bold bg-clip-text text-transparent",o&&u?"bg-gradient-to-r from-amber-600 to-orange-600":"bg-gradient-to-r from-cyan-600 to-teal-600"),children:o&&u?"Admin Panel":"MakeEstimate"})]}),(0,t.jsx)(b.z,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>d(!s),children:s?(0,t.jsx)(y.Z,{className:"h-4 w-4"}):(0,t.jsx)(g.Z,{className:"h-4 w-4"})})]})}),(0,t.jsxs)("nav",{className:"flex-1 p-4 space-y-2",children:[m.map(a=>{let r=a.href.includes("?tab="),n=r?a.href.split("?tab=")[1]:null,c=new URLSearchParams(window.location.search).get("tab"),d=!1;d=r?"/app/glorand"===e&&c===n:"/app/glorand"===a.href?"/app/glorand"===e&&(!c||"users"===c):e===a.href||e?.startsWith?.(a.href+"/");let h=o&&u;return(0,t.jsxs)(i.default,{href:a.href,className:(0,l.cn)("flex items-center space-x-3 px-3 py-2.5 rounded-lg transition-all",d?h?"bg-gradient-to-r from-amber-50 to-orange-50 text-amber-700 font-medium":"bg-gradient-to-r from-cyan-50 to-teal-50 text-cyan-700 font-medium":h?"text-gray-600 hover:bg-amber-50":"text-gray-600 hover:bg-gray-100"),children:[(0,t.jsx)(a.icon,{className:(0,l.cn)("h-5 w-5",d?h?"text-amber-600":"text-cyan-600":"")}),!s&&(0,t.jsx)("span",{children:a.name})]},a.name)}),o&&!u&&(0,t.jsxs)(i.default,{href:"/app/glorand",className:(0,l.cn)("flex items-center space-x-3 px-3 py-2.5 rounded-lg transition-all","text-amber-600 hover:bg-amber-50"),children:[(0,t.jsx)(p.Z,{className:"h-5 w-5"}),!s&&(0,t.jsx)("span",{children:"Admin Panel"})]})]}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-200",children:[!s&&a?.user&&(0,t.jsxs)("div",{className:"mb-3 px-3",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:a.user?.companyName||"Company"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 truncate",children:a.user?.email})]}),(0,t.jsxs)(b.z,{variant:"ghost",className:(0,l.cn)("w-full text-gray-600 hover:text-red-600 hover:bg-red-50",s?"justify-center":"justify-start"),onClick:()=>(0,r.signOut)({callbackUrl:"/login"}),children:[(0,t.jsx)(N.Z,{className:"h-5 w-5"}),!s&&(0,t.jsx)("span",{className:"ml-3",children:"Sign Out"})]})]})]})}var Z=s(1946);function C({children:e}){let{data:a,status:s}=(0,r.useSession)()||{},i=(0,n.useRouter)(),l=(0,n.usePathname)(),[d,o]=(0,c.useState)(!1),[h,u]=(0,c.useState)(null),m=["/app/dashboard","/app/customers","/app/settings","/app/boq"].some(e=>l?.startsWith(e));l?.startsWith("/app/glorand");let x=(0,c.useCallback)(async()=>{try{let e=await fetch("/api/admin/check");if(e.ok){let a=await e.json();return u(a.isAdmin),a.isAdmin}}catch(e){console.error("Failed to check admin status:",e)}return u(!1),!1},[]),f=(0,c.useCallback)(async()=>{if(a?.user){try{let e=await fetch("/api/billing/status");if(e.ok){let a=await e.json();if(a.isBlocked){i.replace(`/blocked${a.blockReason?`?reason=${encodeURIComponent(a.blockReason)}`:""}`);return}if(a.hasTrialGrant&&a.trialEndsAt&&new Date(a.trialEndsAt)<new Date){i.replace("/pricing?trial=ended");return}if(!a.hasActiveSubscription&&!a.hasAdminGrant&&!a.hasTrialGrant){i.replace("/pricing?subscription=required");return}}}catch(e){console.error("Failed to check blocked status:",e)}o(!0)}},[a?.user,i]);return((0,c.useEffect)(()=>{"unauthenticated"===s&&i.replace("/login")},[s,i]),(0,c.useEffect)(()=>{"authenticated"===s&&a?.user&&null===h&&x().then(e=>{e?o(!0):f()})},[s,a?.user,h,x,f]),(0,c.useEffect)(()=>{!0===h&&m&&i.replace("/app/glorand")},[h,m,i]),"loading"!==s&&null!==h&&("authenticated"!==s||d))?a?h&&m?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)(Z.Z,{className:"h-8 w-8 animate-spin text-primary"})}):(0,t.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,t.jsx)(k,{}),(0,t.jsx)("main",{className:"flex-1 overflow-auto",children:e})]}):null:(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)(Z.Z,{className:"h-8 w-8 animate-spin text-primary"})})}},2422:function(e,a,s){"use strict";s.d(a,{d:function(){return l},z:function(){return d}});var t=s(5444),r=s(9300),n=s(223),c=s(2371),i=s(5522);let l=(0,c.j)("inline-flex items-center justify-center rounded-lg text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-emerald-500 text-white hover:bg-emerald-600"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-lg px-3",lg:"h-11 rounded-lg px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef(({className:e,variant:a,size:s,asChild:r=!1,...c},d)=>{let o=r?n.g7:"button";return(0,t.jsx)(o,{className:(0,i.cn)(l({variant:a,size:s,className:e})),ref:d,...c})});d.displayName="Button"},9827:function(e,a,s){"use strict";s.d(a,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return c},aY:function(){return o},ll:function(){return l}});var t=s(5444),r=s(9300),n=s(5522);let c=r.forwardRef(({className:e,...a},s)=>(0,t.jsx)("div",{ref:s,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow-sm",e),...a}));c.displayName="Card";let i=r.forwardRef(({className:e,...a},s)=>(0,t.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...a}));i.displayName="CardHeader";let l=r.forwardRef(({className:e,...a},s)=>(0,t.jsx)("h3",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));l.displayName="CardTitle";let d=r.forwardRef(({className:e,...a},s)=>(0,t.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",e),...a}));d.displayName="CardDescription";let o=r.forwardRef(({className:e,...a},s)=>(0,t.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",e),...a}));o.displayName="CardContent",r.forwardRef(({className:e,...a},s)=>(0,t.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter"},5522:function(e,a,s){"use strict";s.d(a,{cn:function(){return n}});var t=s(2191),r=s(3607);function n(...e){return(0,r.m6)((0,t.W)(e))}},2019:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},6378:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},1137:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},3572:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},1384:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},1946:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},7480:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},6488:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},9484:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},5077:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]])},5038:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]])},4624:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(2154).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},9047:function(e,a,s){"use strict";var t=s(1206);s.o(t,"usePathname")&&s.d(a,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(a,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(a,{useSearchParams:function(){return t.useSearchParams}})}},function(e){e.O(0,[762,162,853,386,156,744],function(){return e(e.s=5638)}),_N_E=e.O()}]);