"use strict";
(() => {
var exports = {};
exports.id = "app/api/customers/route";
exports.ids = ["app/api/customers/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/../../../../opt/hostedapp/node/root/app/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcustomers%2Froute&page=%2Fapi%2Fcustomers%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcustomers%2Froute.ts&appDir=%2Fhome%2Fubuntu%2Fmake_estimate%2Fnextjs_space%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fubuntu%2Fmake_estimate%2Fnextjs_space&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../../../opt/hostedapp/node/root/app/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcustomers%2Froute&page=%2Fapi%2Fcustomers%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcustomers%2Froute.ts&appDir=%2Fhome%2Fubuntu%2Fmake_estimate%2Fnextjs_space%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fubuntu%2Fmake_estimate%2Fnextjs_space&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   originalPathname: () => (/* binding */ originalPathname),
/* harmony export */   patchFetch: () => (/* binding */ patchFetch),
/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),
/* harmony export */   routeModule: () => (/* binding */ routeModule),
/* harmony export */   serverHooks: () => (/* binding */ serverHooks),
/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)
/* harmony export */ });
/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ "(rsc)/../../../../opt/hostedapp/node/root/app/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js");
/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ "(rsc)/../../../../opt/hostedapp/node/root/app/node_modules/next/dist/server/future/route-kind.js");
/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ "(rsc)/../../../../opt/hostedapp/node/root/app/node_modules/next/dist/server/lib/patch-fetch.js");
/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _home_ubuntu_make_estimate_nextjs_space_app_api_customers_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/customers/route.ts */ "(rsc)/./app/api/customers/route.ts");




// We inject the nextConfigOutput here so that we can use them in the route
// module.
const nextConfigOutput = ""
const routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({
    definition: {
        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,
        page: "/api/customers/route",
        pathname: "/api/customers",
        filename: "route",
        bundlePath: "app/api/customers/route"
    },
    resolvedPagePath: "/home/ubuntu/make_estimate/nextjs_space/app/api/customers/route.ts",
    nextConfigOutput,
    userland: _home_ubuntu_make_estimate_nextjs_space_app_api_customers_route_ts__WEBPACK_IMPORTED_MODULE_3__
});
// Pull out the exports that we need to expose from the module. This should
// be eliminated when we've moved the other routes to the new format. These
// are used to hook into the route.
const { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;
const originalPathname = "/api/customers/route";
function patchFetch() {
    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({
        serverHooks,
        staticGenerationAsyncStorage
    });
}


//# sourceMappingURL=app-route.js.map

/***/ }),

/***/ "(rsc)/./app/api/customers/route.ts":
/*!************************************!*\
  !*** ./app/api/customers/route.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GET: () => (/* binding */ GET),
/* harmony export */   POST: () => (/* binding */ POST),
/* harmony export */   dynamic: () => (/* binding */ dynamic)
/* harmony export */ });
/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ "(rsc)/../../../../opt/hostedapp/node/root/app/node_modules/next/dist/api/server.js");
/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth */ "(rsc)/../../../../opt/hostedapp/node/root/app/node_modules/next-auth/index.js");
/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _lib_auth_options__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth-options */ "(rsc)/./lib/auth-options.ts");
/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/db */ "(rsc)/./lib/db.ts");
const dynamic = "force-dynamic";




async function GET() {
    try {
        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth_options__WEBPACK_IMPORTED_MODULE_2__.authOptions);
        if (!session?.user) {
            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({
                error: "Unauthorized"
            }, {
                status: 401
            });
        }
        const companyId = session.user?.companyId;
        if (!companyId) {
            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({
                error: "No company found"
            }, {
                status: 400
            });
        }
        const customers = await _lib_db__WEBPACK_IMPORTED_MODULE_3__.prisma.customer.findMany({
            where: {
                companyId
            },
            orderBy: {
                name: "asc"
            }
        });
        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(customers ?? []);
    } catch (error) {
        console.error("Error fetching customers:", error);
        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({
            error: "Failed to fetch customers"
        }, {
            status: 500
        });
    }
}
async function POST(request) {
    try {
        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth_options__WEBPACK_IMPORTED_MODULE_2__.authOptions);
        if (!session?.user) {
            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({
                error: "Unauthorized"
            }, {
                status: 401
            });
        }
        const companyId = session.user?.companyId;
        if (!companyId) {
            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({
                error: "No company found"
            }, {
                status: 400
            });
        }
        const { name, email, phone, address } = await request.json();
        if (!name) {
            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({
                error: "Name is required"
            }, {
                status: 400
            });
        }
        const customer = await _lib_db__WEBPACK_IMPORTED_MODULE_3__.prisma.customer.create({
            data: {
                companyId,
                name,
                email: email || null,
                phone: phone || null,
                address: address || null
            }
        });
        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(customer);
    } catch (error) {
        console.error("Error creating customer:", error);
        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({
            error: "Failed to create customer"
        }, {
            status: 500
        });
    }
}


/***/ }),

/***/ "(rsc)/./lib/auth-options.ts":
/*!*****************************!*\
  !*** ./lib/auth-options.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   authOptions: () => (/* binding */ authOptions)
/* harmony export */ });
/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/credentials */ "(rsc)/../../../../opt/hostedapp/node/root/app/node_modules/next-auth/providers/credentials.js");
/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ "(rsc)/../../../../opt/hostedapp/node/root/app/node_modules/bcryptjs/index.js");
/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db */ "(rsc)/./lib/db.ts");



const authOptions = {
    providers: [
        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__["default"])({
            name: "credentials",
            credentials: {
                email: {
                    label: "Email",
                    type: "email"
                },
                password: {
                    label: "Password",
                    type: "password"
                }
            },
            async authorize (credentials) {
                if (!credentials?.email || !credentials?.password) {
                    return null;
                }
                const user = await _db__WEBPACK_IMPORTED_MODULE_2__.prisma.user.findUnique({
                    where: {
                        email: credentials.email
                    },
                    include: {
                        memberships: {
                            include: {
                                company: true
                            }
                        }
                    }
                });
                if (!user) return null;
                const isValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compare(credentials.password, user.password);
                if (!isValid) return null;
                // Update lastLoginAt timestamp
                await _db__WEBPACK_IMPORTED_MODULE_2__.prisma.user.update({
                    where: {
                        id: user.id
                    },
                    data: {
                        lastLoginAt: new Date()
                    }
                }).catch((err)=>console.error("Failed to update lastLoginAt:", err));
                const membership = user?.memberships?.[0];
                return {
                    id: user.id,
                    email: user.email,
                    name: user.name,
                    companyId: membership?.companyId ?? null,
                    companyName: membership?.company?.name ?? null,
                    role: membership?.role ?? "MEMBER"
                };
            }
        })
    ],
    callbacks: {
        async jwt ({ token, user }) {
            if (user) {
                token.id = user.id;
                token.companyId = user.companyId;
                token.companyName = user.companyName;
                token.role = user.role;
            }
            return token;
        },
        async session ({ session, token }) {
            if (session?.user) {
                session.user.id = token.id;
                session.user.companyId = token.companyId;
                session.user.companyName = token.companyName;
                session.user.role = token.role;
            }
            return session;
        }
    },
    pages: {
        signIn: "/login"
    },
    session: {
        strategy: "jwt"
    },
    secret: process.env.NEXTAUTH_SECRET
};


/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   prisma: () => (/* binding */ prisma)
/* harmony export */ });
/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ "@prisma/client");
/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _performance__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./performance */ "(rsc)/./lib/performance.ts");


const globalForPrisma = globalThis;
/**
 * Connection Pool Configuration for Scale (10k-50k companies)
 * 
 * Recommended DATABASE_URL parameters:
 *   ?connection_limit=20&pool_timeout=30&connect_timeout=10
 * 
 * - connection_limit: Max connections per Prisma instance (default: num_cpus * 2 + 1)
 *   For serverless/edge: use 1-5
 *   For standard servers: use 10-20
 * 
 * - pool_timeout: Seconds to wait for a connection from pool (default: 10)
 * - connect_timeout: Seconds to wait for new connection (default: 5)
 * 
 * For high-scale production:
 * - Consider PgBouncer or Supabase connection pooler
 * - Use transaction pooling mode for short queries
 * - Monitor with: SELECT * FROM pg_stat_activity;
 */ // Create Prisma client with query logging enabled
function createPrismaClient() {
    const isProduction = "development" === "production";
    const client = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({
        log: isProduction ? [
            {
                level: "error",
                emit: "stdout"
            },
            {
                level: "warn",
                emit: "stdout"
            }
        ] : [
            {
                level: "query",
                emit: "event"
            },
            {
                level: "error",
                emit: "stdout"
            },
            {
                level: "warn",
                emit: "stdout"
            }
        ]
    });
    // Add query event listener for slow query detection (dev + prod with ENABLE_QUERY_LOGGING)
    if (!isProduction || process.env.ENABLE_QUERY_LOGGING === "true") {
        client.$on("query", (e)=>{
            const durationMs = e.duration;
            (0,_performance__WEBPACK_IMPORTED_MODULE_1__.logSlowQuery)({
                query: e.query,
                params: e.params,
                durationMs,
                timestamp: new Date(),
                model: extractModelFromQuery(e.query),
                action: extractActionFromQuery(e.query)
            });
        });
    }
    return client;
}
// Extract model name from SQL query for logging
function extractModelFromQuery(query) {
    const fromMatch = query.match(/FROM\s+["']?public["']?\.?["']?(\w+)["']?/i);
    const insertMatch = query.match(/INSERT\s+INTO\s+["']?public["']?\.?["']?(\w+)["']?/i);
    const updateMatch = query.match(/UPDATE\s+["']?public["']?\.?["']?(\w+)["']?/i);
    const deleteMatch = query.match(/DELETE\s+FROM\s+["']?public["']?\.?["']?(\w+)["']?/i);
    return (fromMatch?.[1] || insertMatch?.[1] || updateMatch?.[1] || deleteMatch?.[1] || "unknown").toLowerCase();
}
// Extract action type from SQL query
function extractActionFromQuery(query) {
    const trimmed = query.trim().toUpperCase();
    if (trimmed.startsWith("SELECT")) return "select";
    if (trimmed.startsWith("INSERT")) return "insert";
    if (trimmed.startsWith("UPDATE")) return "update";
    if (trimmed.startsWith("DELETE")) return "delete";
    if (trimmed.startsWith("BEGIN")) return "transaction";
    if (trimmed.startsWith("COMMIT")) return "commit";
    return "other";
}
// Use singleton pattern to prevent connection storms
// In production, each server instance maintains its own pool
// In development, we reuse across hot reloads
const prisma = globalForPrisma.prisma ?? createPrismaClient();
if (true) {
    globalForPrisma.prisma = prisma;
}


/***/ }),

/***/ "(rsc)/./lib/performance.ts":
/*!****************************!*\
  !*** ./lib/performance.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   createTimer: () => (/* binding */ createTimer),
/* harmony export */   getRecentMetrics: () => (/* binding */ getRecentMetrics),
/* harmony export */   logError: () => (/* binding */ logError),
/* harmony export */   logRequestMetrics: () => (/* binding */ logRequestMetrics),
/* harmony export */   logSlowQuery: () => (/* binding */ logSlowQuery),
/* harmony export */   withTiming: () => (/* binding */ withTiming)
/* harmony export */ });
/**
 * Performance monitoring and logging utilities
 * For tracking request timing, slow queries, and error tracking
 */ // Threshold for slow query logging (in ms)
const SLOW_QUERY_THRESHOLD = parseInt(process.env.SLOW_QUERY_THRESHOLD || "500", 10);
// In-memory metrics buffer for recent requests (circular buffer)
const MAX_METRICS_BUFFER = 1000;
const requestMetricsBuffer = [];
const slowQueryBuffer = [];
/**
 * Log request metrics
 */ function logRequestMetrics(metrics) {
    // Console log for observability
    const logLevel = metrics.durationMs > 1000 ? "warn" : "info";
    const logData = {
        type: "REQUEST_METRICS",
        ...metrics,
        timestamp: metrics.timestamp.toISOString()
    };
    if (logLevel === "warn") {
        console.warn(`[SLOW_REQUEST] ${metrics.method} ${metrics.endpoint} took ${metrics.durationMs}ms`, JSON.stringify(logData));
    } else if (process.env.VERBOSE_LOGGING === "true") {
        console.log(`[REQUEST] ${metrics.method} ${metrics.endpoint} - ${metrics.durationMs}ms`, JSON.stringify(logData));
    }
    // Add to buffer
    requestMetricsBuffer.push(metrics);
    if (requestMetricsBuffer.length > MAX_METRICS_BUFFER) {
        requestMetricsBuffer.shift();
    }
}
/**
 * Log slow query
 */ function logSlowQuery(metrics) {
    if (metrics.durationMs >= SLOW_QUERY_THRESHOLD) {
        console.warn(`[SLOW_QUERY] ${metrics.model}.${metrics.action} took ${metrics.durationMs}ms`, JSON.stringify({
            type: "SLOW_QUERY",
            ...metrics,
            timestamp: metrics.timestamp.toISOString()
        }));
        slowQueryBuffer.push(metrics);
        if (slowQueryBuffer.length > MAX_METRICS_BUFFER) {
            slowQueryBuffer.shift();
        }
    }
}
/**
 * Log application error with context
 */ function logError(error, context) {
    console.error(`[ERROR] ${context.action || context.endpoint || "Unknown"}`, JSON.stringify({
        type: "APP_ERROR",
        message: error.message,
        stack: error.stack,
        name: error.name,
        ...context,
        timestamp: new Date().toISOString()
    }));
}
/**
 * Timer utility for measuring operation duration
 */ function createTimer() {
    const start = performance.now();
    return {
        elapsed: ()=>Math.round(performance.now() - start)
    };
}
/**
 * Wrap an async function with timing and error tracking
 */ async function withTiming(operation, fn, context) {
    const timer = createTimer();
    try {
        const result = await fn();
        const durationMs = timer.elapsed();
        if (durationMs > 1000) {
            console.warn(`[SLOW_OP] ${operation} took ${durationMs}ms`, context);
        }
        return {
            result,
            durationMs
        };
    } catch (error) {
        logError(error, {
            action: operation,
            ...context
        });
        throw error;
    }
}
/**
 * Get recent metrics for debugging/admin
 */ function getRecentMetrics() {
    return {
        requests: requestMetricsBuffer.slice(-100),
        slowQueries: slowQueryBuffer.slice(-100),
        summary: {
            totalRequests: requestMetricsBuffer.length,
            slowRequests: requestMetricsBuffer.filter((r)=>r.durationMs > 1000).length,
            slowQueries: slowQueryBuffer.length,
            avgRequestTime: requestMetricsBuffer.length > 0 ? Math.round(requestMetricsBuffer.reduce((sum, r)=>sum + r.durationMs, 0) / requestMetricsBuffer.length) : 0
        }
    };
}


/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/bcryptjs","vendor-chunks/oauth","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/uuid","vendor-chunks/preact-render-to-string","vendor-chunks/oidc-token-hash","vendor-chunks/@panva"], () => (__webpack_exec__("(rsc)/../../../../opt/hostedapp/node/root/app/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcustomers%2Froute&page=%2Fapi%2Fcustomers%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcustomers%2Froute.ts&appDir=%2Fhome%2Fubuntu%2Fmake_estimate%2Fnextjs_space%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fubuntu%2Fmake_estimate%2Fnextjs_space&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();