(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[792],{6085:function(e,s,t){Promise.resolve().then(t.bind(t,5988))},5988:function(e,s,t){"use strict";t.d(s,{TemplatesClient:function(){return w}});var a=t(5444),r=t(9300),l=t(7367),i=t(2422),n=t(9827),c=t(1335),d=t(6765),o=t(9530),m=t(6948),x=t(892),u=t(6771),h=t(1946),p=t(9429),f=t(362),g=t(9582),j=t(3705),v=t(563),b=t(9062),N=t(4611),y=t(1084);function w({boqTemplates:e,coverTemplates:s,billingStatus:t,companyName:w}){let[C,Z]=(0,r.useState)(e),[k,D]=(0,r.useState)(s),[T,z]=(0,r.useState)("boq"),[P,O]=(0,r.useState)(!1),[S,q]=(0,r.useState)("boq_templates"),[_,B]=(0,r.useState)(!1),[E,Q]=(0,r.useState)(null),[$,A]=(0,r.useState)(!1),[V,U]=(0,r.useState)(!1),F=t.boqTemplatesLimit??null,L=t.coverTemplatesLimit??null,R=null===F||C.length<(F??1/0),Y=null===L||k.length<(L??1/0),M=t.planKey||"free",X=async()=>{if(!R){q("boq_templates"),O(!0);return}U(!0);try{let e=await fetch("/api/pdf-themes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:`Theme ${C.length+1}`})}),s=await e.json();if(!e.ok){403===e.status&&"LIMIT_EXCEEDED"===s.code?(q("boq_templates"),O(!0)):N.ZP.error(s?.error||"Failed to create theme");return}Z([...C,s]),N.ZP.success("BOQ theme created")}catch(e){N.ZP.error("An error occurred")}finally{U(!1)}},I=async()=>{if(!Y){q("cover_templates"),O(!0);return}U(!0);try{let e=await fetch("/api/cover-templates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:`Cover ${k.length+1}`})}),s=await e.json();if(!e.ok){403===e.status&&"LIMIT_EXCEEDED"===s.code?(q("cover_templates"),O(!0)):N.ZP.error(s?.error||"Failed to create cover template");return}D([...k,s]),N.ZP.success("Cover template created")}catch(e){N.ZP.error("An error occurred")}finally{U(!1)}},J=(e,s,t)=>{Q({id:e,type:s,name:t}),B(!0)},K=async()=>{if(E){A(!0);try{let e="boq"===E.type?`/api/pdf-themes/${E.id}`:`/api/cover-templates/${E.id}`,s=await fetch(e,{method:"DELETE"});if(!s.ok){let e=await s.json();N.ZP.error(e?.error||"Failed to delete template");return}"boq"===E.type?Z(e=>e.filter(e=>e.id!==E.id)):D(e=>e.filter(e=>e.id!==E.id)),N.ZP.success("Template deleted"),B(!1),Q(null)}catch(e){N.ZP.error("An error occurred")}finally{A(!1)}}},H=async(e,s)=>{try{let t="boq"===s?`/api/pdf-themes/${e}`:`/api/cover-templates/${e}`;if(!(await fetch(t,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isDefault:!0})})).ok){N.ZP.error("Failed to set as default");return}"boq"===s?Z(s=>s.map(s=>({...s,isDefault:s.id===e}))):D(s=>s.map(s=>({...s,isDefault:s.id===e}))),N.ZP.success("Default template updated")}catch(e){N.ZP.error("An error occurred")}},G=()=>({limit:"boq_templates"===S?F:L,current:"boq_templates"===S?C.length:k.length,typeName:"boq_templates"===S?"BOQ themes":"cover templates",planName:M.charAt(0).toUpperCase()+M.slice(1)});return(0,a.jsx)(l.AppLayout,{children:(0,a.jsxs)("div",{className:"p-6 max-w-5xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Templates"}),(0,a.jsx)("p",{className:"text-gray-500 mt-1",children:"Manage your BOQ themes and cover page templates"})]}),(0,a.jsxs)(d.mQ,{value:T,onValueChange:z,className:"space-y-6",children:[(0,a.jsxs)(d.dr,{className:"grid w-full grid-cols-2 max-w-md",children:[(0,a.jsxs)(d.SP,{value:"boq",className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),"BOQ Themes"]}),(0,a.jsxs)(d.SP,{value:"cover",className:"flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4"}),"Cover Pages"]})]}),(0,a.jsx)(d.nU,{value:"boq",className:"space-y-6",children:(0,a.jsxs)(n.Zb,{className:"shadow-md border-0",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(n.ll,{className:"text-lg",children:"BOQ Themes"}),(0,a.jsx)(n.SZ,{children:"Customize colors and styles for your BOQ PDF exports"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[null!==F&&(0,a.jsxs)(c.C,{variant:"outline",className:"text-sm",children:[C.length,"/",F," used"]}),(0,a.jsxs)(i.z,{onClick:X,disabled:V||!R,size:"sm",children:[V?(0,a.jsx)(h.Z,{className:"w-4 h-4 animate-spin mr-2"}):(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Create Theme"]})]})]})}),(0,a.jsxs)(n.aY,{children:[!R&&(0,a.jsxs)(m.bZ,{className:"mb-4 border-amber-200 bg-amber-50",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 text-amber-600"}),(0,a.jsx)(m.Cd,{className:"text-amber-800",children:"Theme limit reached"}),(0,a.jsxs)(m.X,{className:"text-amber-700",children:["You've used all ",F," BOQ themes available on the ",M," plan.",(0,a.jsx)(y.default,{href:"/pricing",className:"ml-1 underline font-medium",children:"Upgrade for more"})]})]}),0===C.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(x.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No BOQ themes yet"}),(0,a.jsx)(i.z,{variant:"outline",className:"mt-4",onClick:X,disabled:V,children:"Create your first theme"})]}):(0,a.jsx)("div",{className:"space-y-3",children:C.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors group",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-400 to-lavender-400 rounded-lg flex items-center justify-center",children:(0,a.jsx)(x.Z,{className:"w-5 h-5 text-white"})}),(0,a.jsx)("div",{children:(0,a.jsxs)("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.name,e.isDefault&&(0,a.jsxs)(c.C,{variant:"secondary",className:"text-xs",children:[(0,a.jsx)(g.Z,{className:"w-3 h-3 mr-1"}),"Default"]})]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!e.isDefault&&(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>H(e.id,"boq"),className:"text-gray-500 hover:text-purple-600",children:"Set Default"}),(0,a.jsx)(y.default,{href:"/app/settings?tab=pdf",children:(0,a.jsx)(i.z,{variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(j.Z,{className:"w-4 h-4"})})}),!e.isDefault&&(0,a.jsx)(i.z,{variant:"ghost",size:"icon",className:"text-gray-400 hover:text-red-500",onClick:()=>J(e.id,"boq",e.name),children:(0,a.jsx)(v.Z,{className:"w-4 h-4"})})]})]},e.id))})]})]})}),(0,a.jsx)(d.nU,{value:"cover",className:"space-y-6",children:(0,a.jsxs)(n.Zb,{className:"shadow-md border-0",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(n.ll,{className:"text-lg",children:"Cover Page Templates"}),(0,a.jsx)(n.SZ,{children:"Design cover pages for your BOQ PDF exports"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[null!==L&&(0,a.jsxs)(c.C,{variant:"outline",className:"text-sm",children:[k.length,"/",L," used"]}),(0,a.jsxs)(i.z,{onClick:I,disabled:V||!Y,size:"sm",children:[V?(0,a.jsx)(h.Z,{className:"w-4 h-4 animate-spin mr-2"}):(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Create Cover"]})]})]})}),(0,a.jsxs)(n.aY,{children:[!Y&&(0,a.jsxs)(m.bZ,{className:"mb-4 border-amber-200 bg-amber-50",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 text-amber-600"}),(0,a.jsx)(m.Cd,{className:"text-amber-800",children:"Cover template limit reached"}),(0,a.jsxs)(m.X,{className:"text-amber-700",children:["You've used all ",L," cover templates available on the ",M," plan.",(0,a.jsx)(y.default,{href:"/pricing",className:"ml-1 underline font-medium",children:"Upgrade for more"})]})]}),0===k.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(u.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No cover templates yet"}),(0,a.jsx)(i.z,{variant:"outline",className:"mt-4",onClick:I,disabled:V,children:"Create your first cover"})]}):(0,a.jsx)("div",{className:"space-y-3",children:k.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors group",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-400 to-lavender-400 rounded-lg flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-5 h-5 text-white"})}),(0,a.jsx)("div",{children:(0,a.jsxs)("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.name,e.isDefault&&(0,a.jsxs)(c.C,{variant:"secondary",className:"text-xs",children:[(0,a.jsx)(g.Z,{className:"w-3 h-3 mr-1"}),"Default"]})]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!e.isDefault&&(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>H(e.id,"cover"),className:"text-gray-500 hover:text-purple-600",children:"Set Default"}),(0,a.jsx)(y.default,{href:"/app/settings?tab=pdf",children:(0,a.jsx)(i.z,{variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(j.Z,{className:"w-4 h-4"})})}),!e.isDefault&&(0,a.jsx)(i.z,{variant:"ghost",size:"icon",className:"text-gray-400 hover:text-red-500",onClick:()=>J(e.id,"cover",e.name),children:(0,a.jsx)(v.Z,{className:"w-4 h-4"})})]})]},e.id))})]})]})})]}),(0,a.jsx)(o.Vq,{open:P,onOpenChange:O,children:(0,a.jsxs)(o.cZ,{children:[(0,a.jsxs)(o.fK,{children:[(0,a.jsxs)(o.$N,{className:"flex items-center gap-2",children:[(0,a.jsx)(b.Z,{className:"w-5 h-5 text-amber-500"}),"Upgrade to Create More"]}),(0,a.jsx)(o.Be,{children:(()=>{let{limit:e,current:s,typeName:t,planName:a}=G();return`You've reached the ${a} plan limit of ${e} ${t}. Upgrade your plan to create more.`})()})]}),(0,a.jsx)("div",{className:"py-4",children:(0,a.jsxs)("div",{className:"bg-purple-50 rounded-xl p-4 border border-purple-100",children:[(0,a.jsx)("h4",{className:"font-medium text-purple-900 mb-2",children:"Upgrade Benefits:"}),(0,a.jsxs)("ul",{className:"text-sm text-purple-700 space-y-1",children:[(0,a.jsx)("li",{children:"• More BOQ themes and cover templates"}),(0,a.jsx)("li",{children:"• Logo upload for cover pages"}),(0,a.jsx)("li",{children:"• Remove watermark from PDFs"}),(0,a.jsx)("li",{children:"• Higher BOQ creation limits"})]})]})}),(0,a.jsxs)(o.cN,{children:[(0,a.jsx)(i.z,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),(0,a.jsx)(y.default,{href:"/pricing",children:(0,a.jsxs)(i.z,{children:[(0,a.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"View Plans"]})})]})]})}),(0,a.jsx)(o.Vq,{open:_,onOpenChange:B,children:(0,a.jsxs)(o.cZ,{children:[(0,a.jsxs)(o.fK,{children:[(0,a.jsxs)(o.$N,{className:"flex items-center gap-2 text-red-600",children:[(0,a.jsx)(f.Z,{className:"w-5 h-5"}),"Delete Template?"]}),(0,a.jsxs)(o.Be,{children:["This will permanently delete ",(0,a.jsxs)("strong",{children:['"',E?.name,'"']}),". This action cannot be undone."]})]}),(0,a.jsxs)(o.cN,{children:[(0,a.jsx)(i.z,{variant:"outline",onClick:()=>B(!1),disabled:$,children:"Cancel"}),(0,a.jsxs)(i.z,{variant:"destructive",onClick:K,disabled:$,children:[$&&(0,a.jsx)(h.Z,{className:"w-4 h-4 animate-spin mr-2"}),"Delete"]})]})]})})]})})}},6948:function(e,s,t){"use strict";t.d(s,{Cd:function(){return d},X:function(){return o},bZ:function(){return c}});var a=t(5444),r=t(9300),l=t(2371),i=t(5522);let n=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=r.forwardRef(({className:e,variant:s,...t},r)=>(0,a.jsx)("div",{ref:r,role:"alert",className:(0,i.cn)(n({variant:s}),e),...t}));c.displayName="Alert";let d=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",e),...s}));d.displayName="AlertTitle";let o=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",e),...s}));o.displayName="AlertDescription"},1335:function(e,s,t){"use strict";t.d(s,{C:function(){return n}});var a=t(5444);t(9300);var r=t(2371),l=t(5522);let i=(0,r.j)("inline-flex items-center rounded-full border px-3 py-1 text-xs font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-gradient-to-r from-purple-500 to-lavender-500 text-white",secondary:"border-transparent bg-purple-100 text-purple-700 hover:bg-purple-200",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border-purple-200 text-purple-700 bg-white",success:"border-transparent bg-emerald-100 text-emerald-700",warning:"border-transparent bg-amber-100 text-amber-700"}},defaultVariants:{variant:"default"}});function n({className:e,variant:s,...t}){return(0,a.jsx)("div",{className:(0,l.cn)(i({variant:s}),e),...t})}},6765:function(e,s,t){"use strict";t.d(s,{SP:function(){return d},dr:function(){return c},mQ:function(){return n},nU:function(){return o}});var a=t(5444),r=t(9300),l=t(9035),i=t(5522);let n=l.fC,c=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.aV,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));c.displayName=l.aV.displayName;let d=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));d.displayName=l.xz.displayName;let o=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));o.displayName=l.VY.displayName}},function(e){e.O(0,[762,162,84,206,542,75,861,408,386,156,744],function(){return e(e.s=6085)}),_N_E=e.O()}]);